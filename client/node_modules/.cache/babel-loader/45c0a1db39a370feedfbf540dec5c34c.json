{"ast":null,"code":"import _defineProperty from\"E:/MERN stack project/fullStack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"E:/MERN stack project/fullStack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"E:/MERN stack project/fullStack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/MERN stack project/fullStack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:/MERN stack project/fullStack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import React,{useEffect,useState}from\"react\";import{SuccessShow,ErrShow}from\"../auth/notification/Notification\";import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var initialState={password:\"\",rf_password:\"\",err:\"\",success:\"\"};//asdasdsadsa \nvar initialProduct={species:\"\",nameProduct:\"\",errProduct:\"\",successProduct:\"\"};var User=function User(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(initialState),_useState4=_slicedToArray(_useState3,2),changePassword=_useState4[0],setChangePassword=_useState4[1];var _useState5=useState(initialProduct),_useState6=_slicedToArray(_useState5,2),uploadProduct=_useState6[0],setUploadProduct=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),hide=_useState8[0],setHide=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),avatar=_useState10[0],setAvatar=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),loading=_useState12[0],setLoading=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),loadingUpload=_useState14[0],setLoadingUpload=_useState14[1];//   const [exit, setExit] = useState(true);\nvar _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),imageProduct=_useState16[0],setImageProduct=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),cloudinary=_useState18[0],setCloundinary=_useState18[1];var email=user.email;var id=user._id;var password=changePassword.password,rf_password=changePassword.rf_password,err=changePassword.err,success=changePassword.success;var species=uploadProduct.species,nameProduct=uploadProduct.nameProduct,errProduct=uploadProduct.errProduct,successProduct=uploadProduct.successProduct;useEffect(function(){var userData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/user/profile\",{headers:{\"auth-token\":localStorage.account}});case 3:res=_context.sent;setUser(res.data.user);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function userData(){return _ref.apply(this,arguments);};}();userData();},[localStorage.account]);var handleChangePassword=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();_context2.prev=1;if(user._id){_context2.next=4;break;}return _context2.abrupt(\"return\",setChangePassword(_objectSpread(_objectSpread({},changePassword),{},{password:\"\",rf_password:\"\",err:\"Not found user.\",success:\"\"})));case 4:_context2.next=6;return axios.patch(\"/user/changePassword/\".concat(user._id),{password:password,rf_password:rf_password});case 6:res=_context2.sent;setChangePassword(_objectSpread(_objectSpread({},changePassword),{},{password:\"\",rf_password:\"\",err:\"\",success:res.data.msg}));_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);_context2.t0.response.data.msg&&setChangePassword(_objectSpread(_objectSpread({},changePassword),{},{password:password,rf_password:rf_password,err:_context2.t0.response.data.msg,success:\"\"}));case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[1,10]]);}));return function handleChangePassword(_x){return _ref2.apply(this,arguments);};}();var handleChangeInput=function handleChangeInput(e){var _objectSpread2,_objectSpread3;var _e$target=e.target,name=_e$target.name,value=_e$target.value;setUploadProduct(_objectSpread(_objectSpread({},uploadProduct),{},(_objectSpread2={},_defineProperty(_objectSpread2,name,value),_defineProperty(_objectSpread2,\"errProduct\",\"\"),_defineProperty(_objectSpread2,\"successProduct\",\"\"),_objectSpread2)));setChangePassword(_objectSpread(_objectSpread({},changePassword),{},(_objectSpread3={},_defineProperty(_objectSpread3,name,value),_defineProperty(_objectSpread3,\"err\",\"\"),_defineProperty(_objectSpread3,\"success\",\"\"),_objectSpread3)));};var changeAvatar=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var file,formData,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.preventDefault();_context3.prev=1;file=e.target.files[0];formData=new FormData();formData.append(\"avatar\",file);formData.append(\"email\",email);setLoading(true);_context3.next=9;return axios.post(\"/user/upload_avatar\",formData,{headers:{\"content-Type\":\"multipart/form-data\"}});case 9:res=_context3.sent;setLoading(false);setAvatar(res.data.url);window.location.href=\"/user\";_context3.next=18;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](1);_context3.t0.response.data.msg&&setUser(_objectSpread(_objectSpread({},user),{},{err:_context3.t0.response.data.msg,success:\"\"}));case 18:case\"end\":return _context3.stop();}}},_callee3,null,[[1,15]]);}));return function changeAvatar(_x2){return _ref3.apply(this,arguments);};}();var handleSubmitUploadProduct=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e){var file,formData,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:e.preventDefault();_context4.prev=1;file=e.target.files[0];formData=new FormData();formData.append(\"image\",file);setLoadingUpload(true);_context4.next=8;return axios.post(\"/user/upload_product\",formData,{headers:{\"content-Type\":\"multipart/form-data\"}});case 8:res=_context4.sent;if(res){_context4.next=11;break;}return _context4.abrupt(\"return\",setUploadProduct(_objectSpread(_objectSpread({},uploadProduct),{},{errProduct:\"Not found upload!\"})));case 11:setLoadingUpload(false);setImageProduct(res.data.image);setCloundinary(res.data.cloudinary_id);_context4.next=20;break;case 16:_context4.prev=16;_context4.t0=_context4[\"catch\"](1);_context4.t0.response.data.msg&&setUploadProduct(_objectSpread(_objectSpread({},uploadProduct),{},{errProduct:_context4.t0.response.data.msg,successProduct:\"\"}));console.log(_context4.t0);case 20:case\"end\":return _context4.stop();}}},_callee4,null,[[1,16]]);}));return function handleSubmitUploadProduct(_x3){return _ref4.apply(this,arguments);};}();var updateProduct=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(e){var res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:e.preventDefault();_context5.prev=1;_context5.next=4;return axios.post(\"/user/upload\",{id:id,species:species,nameProduct:nameProduct,imageProduct:imageProduct,cloudinary:cloudinary});case 4:res=_context5.sent;if(res){_context5.next=7;break;}return _context5.abrupt(\"return\",setUploadProduct(_objectSpread(_objectSpread({},updateProduct),{},{errProduct:\"Product does not upload!\"})));case 7:setUploadProduct(_objectSpread(_objectSpread({},uploadProduct),{},{species:\"\",nameProduct:\"\",errProduct:\"\",successProduct:res.data.msg}));setImageProduct(false);_context5.next=14;break;case 11:_context5.prev=11;_context5.t0=_context5[\"catch\"](1);_context5.t0.response.data.msg&&setUploadProduct(_objectSpread(_objectSpread({},uploadProduct),{},{errProduct:_context5.t0.response.data.msg,successProduct:\"\"}));case 14:case\"end\":return _context5.stop();}}},_callee5,null,[[1,11]]);}));return function updateProduct(_x4){return _ref5.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"profile-user\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"box-profile\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"avatar\",children:[/*#__PURE__*/_jsx(\"img\",{src:avatar?avatar:user.avatar,alt:\"\"}),loading&&/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-spinner fa-spin loading\"}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-camera\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"avatar\",id:\"file_up\",onChange:changeAvatar})]})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Name: \"}),user.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Email: \"}),user.email]}),err&&ErrShow(err),success&&SuccessShow(success),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleChangePassword,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"changePassword\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Password m\\u1EDBi\"}),/*#__PURE__*/_jsx(\"input\",{type:hide?\"password\":\"text\",name:\"password\",value:password,onChange:handleChangeInput,placeholder:\"Nh\\u1EADp password m\\u1EDBi\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"changePassword\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Nh\\u1EADp l\\u1EA1i password m\\u1EDBi\"}),/*#__PURE__*/_jsx(\"input\",{type:hide?\"password\":\"text\",name:\"rf_password\",value:rf_password,onChange:handleChangeInput,placeholder:\"Nh\\u1EADp l\\u1EA1i password\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"hide-password\",children:[\"Hide password\",/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",onClick:function onClick(){return setHide(!hide);}})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Thay \\u0111\\u1ED5i\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"box-upload\",children:[errProduct&&ErrShow(errProduct),successProduct&&SuccessShow(successProduct),/*#__PURE__*/_jsxs(\"div\",{className:\"form-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Lo\\u1EA1i s\\u1EA3n ph\\u1EA9m\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"species\",value:species,onChange:handleChangeInput,placeholder:\"Nh\\u1EADp lo\\u1EA1i s\\u1EA3n ph\\u1EA9m...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"T\\xEAn s\\u1EA3n ph\\u1EA9m\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"nameProduct\",value:nameProduct,onChange:handleChangeInput,placeholder:\"Nh\\u1EADp t\\xEAn s\\u1EA3n ph\\u1EA9m...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u1EA2nh s\\u1EA3n ph\\u1EA9m\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleSubmitUploadProduct})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-upload\",children:[loadingUpload&&/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-spinner fa-spin loadingUpload\"}),imageProduct&&/*#__PURE__*/_jsx(\"img\",{src:imageProduct,alt:\"\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:updateProduct,children:\"\\u0110\\u0103ng\"}),/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(Link,{to:\"/user/product\",children:\"C\\xE1c s\\u1EA3n ph\\u1EA9m \\u0111\\xE3 \\u0111\\u0103ng\"})})]})]})});};export default User;","map":{"version":3,"sources":["E:/MERN stack project/fullStack/client/src/user/User.js"],"names":["axios","React","useEffect","useState","SuccessShow","ErrShow","Link","initialState","password","rf_password","err","success","initialProduct","species","nameProduct","errProduct","successProduct","User","user","setUser","changePassword","setChangePassword","uploadProduct","setUploadProduct","hide","setHide","avatar","setAvatar","loading","setLoading","loadingUpload","setLoadingUpload","imageProduct","setImageProduct","cloudinary","setCloundinary","email","id","_id","userData","get","headers","localStorage","account","res","data","console","log","handleChangePassword","e","preventDefault","patch","msg","response","handleChangeInput","target","name","value","changeAvatar","file","files","formData","FormData","append","post","url","window","location","href","handleSubmitUploadProduct","image","cloudinary_id","updateProduct"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { SuccessShow, ErrShow } from \"../auth/notification/Notification\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst initialState = {\r\n  password: \"\",\r\n  rf_password: \"\",\r\n  err: \"\",\r\n  success: \"\",\r\n};\r\n//asdasdsadsa \r\nconst initialProduct = {\r\n  species: \"\",\r\n  nameProduct: \"\",\r\n  errProduct: \"\",\r\n  successProduct: \"\",\r\n};\r\n\r\nconst User = () => {\r\n  const [user, setUser] = useState({});\r\n  const [changePassword, setChangePassword] = useState(initialState);\r\n  const [uploadProduct, setUploadProduct] = useState(initialProduct);\r\n\r\n  const [hide, setHide] = useState(true);\r\n  const [avatar, setAvatar] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingUpload, setLoadingUpload] = useState(false);\r\n  //   const [exit, setExit] = useState(true);\r\n  const [imageProduct, setImageProduct] = useState(false);\r\n  const [cloudinary, setCloundinary] = useState(\"\");\r\n\r\n  const { email } = user;\r\n  const id = user._id;\r\n  const { password, rf_password, err, success } = changePassword;\r\n  const { species, nameProduct, errProduct, successProduct } = uploadProduct;\r\n\r\n  useEffect(() => {\r\n    const userData = async () => {\r\n      try {\r\n        const res = await axios.get(\"/user/profile\", {\r\n          headers: { \"auth-token\": localStorage.account },\r\n        });\r\n        setUser(res.data.user);\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n    userData();\r\n  }, [localStorage.account]);\r\n\r\n  const handleChangePassword = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      if (!user._id)\r\n        return setChangePassword({\r\n          ...changePassword,\r\n          password: \"\",\r\n          rf_password: \"\",\r\n          err: \"Not found user.\",\r\n          success: \"\",\r\n        });\r\n\r\n      const res = await axios.patch(`/user/changePassword/${user._id}`, {\r\n        password,\r\n        rf_password,\r\n      });\r\n      setChangePassword({\r\n        ...changePassword,\r\n        password: \"\",\r\n        rf_password: \"\",\r\n        err: \"\",\r\n        success: res.data.msg,\r\n      });\r\n    } catch (err) {\r\n      err.response.data.msg &&\r\n        setChangePassword({\r\n          ...changePassword,\r\n          password: password,\r\n          rf_password: rf_password,\r\n          err: err.response.data.msg,\r\n          success: \"\",\r\n        });\r\n    }\r\n  };\r\n\r\n  const handleChangeInput = (e) => {\r\n    const { name, value } = e.target;\r\n    setUploadProduct({\r\n      ...uploadProduct,\r\n      [name]: value,\r\n      errProduct: \"\",\r\n      successProduct: \"\",\r\n    });\r\n    setChangePassword({\r\n      ...changePassword,\r\n      [name]: value,\r\n      err: \"\",\r\n      success: \"\",\r\n    });\r\n  };\r\n\r\n  const changeAvatar = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const file = e.target.files[0];\r\n      let formData = new FormData();\r\n      formData.append(\"avatar\", file);\r\n      formData.append(\"email\", email);\r\n\r\n      setLoading(true);\r\n      const res = await axios.post(`/user/upload_avatar`, formData, {\r\n        headers: {\r\n          \"content-Type\": \"multipart/form-data\",\r\n        },\r\n      });\r\n\r\n      setLoading(false);\r\n      setAvatar(res.data.url);\r\n      window.location.href = \"/user\";\r\n    } catch (err) {\r\n      err.response.data.msg &&\r\n        setUser({ ...user, err: err.response.data.msg, success: \"\" });\r\n    }\r\n  };\r\n\r\n  const handleSubmitUploadProduct = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const file = e.target.files[0];\r\n      let formData = new FormData();\r\n      formData.append(\"image\", file);\r\n      setLoadingUpload(true);\r\n\r\n      const res = await axios.post(`/user/upload_product`, formData, {\r\n        headers: {\r\n          \"content-Type\": \"multipart/form-data\",\r\n        },\r\n      });\r\n\r\n      if (!res)\r\n        return setUploadProduct({\r\n          ...uploadProduct,\r\n          errProduct: \"Not found upload!\",\r\n        });\r\n      setLoadingUpload(false);\r\n      setImageProduct(res.data.image);\r\n      setCloundinary(res.data.cloudinary_id);\r\n    } catch (err) {\r\n      err.response.data.msg &&\r\n        setUploadProduct({\r\n          ...uploadProduct,\r\n          errProduct: err.response.data.msg,\r\n          successProduct: \"\",\r\n        });\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  const updateProduct = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const res = await axios.post(\"/user/upload\", {\r\n        id,\r\n        species,\r\n        nameProduct,\r\n        imageProduct,\r\n        cloudinary,\r\n      });\r\n\r\n      if (!res)\r\n        return setUploadProduct({\r\n          ...updateProduct,\r\n          errProduct: \"Product does not upload!\",\r\n        });\r\n\r\n      setUploadProduct({\r\n        ...uploadProduct,\r\n        species: \"\",\r\n        nameProduct: \"\",\r\n        errProduct: \"\",\r\n        successProduct: res.data.msg,\r\n      });\r\n      setImageProduct(false);\r\n    } catch (err) {\r\n      err.response.data.msg &&\r\n        setUploadProduct({\r\n          ...uploadProduct,\r\n          errProduct: err.response.data.msg,\r\n          successProduct: \"\",\r\n        });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <section>\r\n      <div className=\"profile-user\">\r\n        <div className=\"box-profile\">\r\n          <div className=\"avatar\">\r\n            <img src={avatar ? avatar : user.avatar} alt=\"\" />\r\n            {loading && <i className=\"fas fa-spinner fa-spin loading\"></i>}\r\n            <span>\r\n              <i className=\"fas fa-camera\"></i>\r\n              <input\r\n                type=\"file\"\r\n                name=\"avatar\"\r\n                id=\"file_up\"\r\n                onChange={changeAvatar}\r\n              />\r\n            </span>\r\n          </div>\r\n          <p>\r\n            <span>Name: </span>\r\n            {user.name}\r\n          </p>\r\n          <p>\r\n            <span>Email: </span>\r\n            {user.email}\r\n          </p>\r\n          {err && ErrShow(err)}\r\n          {success && SuccessShow(success)}\r\n          <form onSubmit={handleChangePassword}>\r\n            <div className=\"changePassword\">\r\n              <label>Password mới</label>\r\n              <input\r\n                type={hide ? \"password\" : \"text\"}\r\n                name=\"password\"\r\n                value={password}\r\n                onChange={handleChangeInput}\r\n                placeholder=\"Nhập password mới\"\r\n              />\r\n            </div>\r\n            <div className=\"changePassword\">\r\n              <label>Nhập lại password mới</label>\r\n              <input\r\n                type={hide ? \"password\" : \"text\"}\r\n                name=\"rf_password\"\r\n                value={rf_password}\r\n                onChange={handleChangeInput}\r\n                placeholder=\"Nhập lại password\"\r\n              />\r\n            </div>\r\n            <div className=\"hide-password\">\r\n              Hide password\r\n              <input type=\"checkbox\" onClick={() => setHide(!hide)} />\r\n            </div>\r\n            <button type=\"submit\">Thay đổi</button>\r\n          </form>\r\n        </div>\r\n        <div className=\"box-upload\">\r\n          {errProduct && ErrShow(errProduct)}\r\n          {successProduct && SuccessShow(successProduct)}\r\n          <div className=\"form-item\">\r\n            <label>Loại sản phẩm</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"species\"\r\n              value={species}\r\n              onChange={handleChangeInput}\r\n              placeholder=\"Nhập loại sản phẩm...\"\r\n            />\r\n          </div>\r\n          <div className=\"form-item\">\r\n            <label>Tên sản phẩm</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"nameProduct\"\r\n              value={nameProduct}\r\n              onChange={handleChangeInput}\r\n              placeholder=\"Nhập tên sản phẩm...\"\r\n            />\r\n          </div>\r\n          <div className=\"form-item\">\r\n            <label>Ảnh sản phẩm</label>\r\n            <input type=\"file\" onChange={handleSubmitUploadProduct} />\r\n          </div>\r\n          <div className=\"product-upload\">\r\n            {loadingUpload && (\r\n              <i className=\"fas fa-spinner fa-spin loadingUpload\"></i>\r\n            )}\r\n            {imageProduct && <img src={imageProduct} alt=\"\" />}\r\n          </div>\r\n          <button onClick={updateProduct}>Đăng</button>\r\n          <button>\r\n            <Link to=\"/user/product\">Các sản phẩm đã đăng</Link>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default User;\r\n"]},"metadata":{},"sourceType":"module"}