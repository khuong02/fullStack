{"ast":null,"code":"import _regeneratorRuntime from\"E:/MERN stack project/fullStack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/MERN stack project/fullStack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"E:/MERN stack project/fullStack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"E:/MERN stack project/fullStack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"E:/MERN stack project/fullStack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Link,useHistory}from\"react-router-dom\";import axios from\"axios\";import React,{useState}from\"react\";import{dispatchLogin}from\"../../redux/actions/authAction\";import{useDispatch}from\"react-redux\";import{useSelector}from\"react-redux\";import{ErrShow,SuccessShow}from\"../notification/Notification\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var initState={email:\"\",password:\"\",err:\"\",success:\"\"};var Login=function Login(){var history=useHistory();var _useState=useState(initState),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),hide=_useState4[0],setHide=_useState4[1];var dispatch=useDispatch();var auth=useSelector(function(state){return state.auth;});var email=user.email,password=user.password,err=user.err,success=user.success;var handleChangeInput=function handleChangeInput(e){var _objectSpread2;var _e$target=e.target,name=_e$target.name,value=_e$target.value;setUser(_objectSpread(_objectSpread({},user),{},(_objectSpread2={},_defineProperty(_objectSpread2,name,value),_defineProperty(_objectSpread2,\"err\",\"\"),_defineProperty(_objectSpread2,\"success\",\"\"),_objectSpread2)));};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return axios.post(\"/user/login\",{email:email,password:password});case 4:res=_context.sent;setUser(_objectSpread(_objectSpread({},user),{},{err:\"\",success:\"Đăng nhập thành công!\"}));auth.user.push(res.data);localStorage.setItem(\"account\",res.data.accessToken);dispatch(dispatchLogin());history.replace(\"/\");_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](1);_context.t0.response.data.msg&&setUser(_objectSpread(_objectSpread({},user),{},{err:_context.t0.response.data.msg,success:\"\"}));case 15:case\"end\":return _context.stop();}}},_callee,null,[[1,12]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"form\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"box-form\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Login\"}),err&&ErrShow(err),success&&SuccessShow(success),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{id:\"email\",name:\"email\",value:email,onChange:handleChangeInput,placeholder:\"Nh\\u1EADp email...\",type:\"email\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{id:\"password\",name:\"password\",value:password,onChange:handleChangeInput,placeholder:\"Nh\\u1EADp password...\",type:hide?\"password\":\"text\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Hide password\",/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",onClick:function onClick(){return setHide(!hide);}})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"\\u0110\\u0103ng nh\\u1EADp\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Create new user!\",/*#__PURE__*/_jsx(Link,{to:\"/user/register\",children:\"Register!\"})]})]})})});};export default Login;","map":{"version":3,"sources":["E:/MERN stack project/fullStack/client/src/auth/form/Login.js"],"names":["Link","useHistory","axios","React","useState","dispatchLogin","useDispatch","useSelector","ErrShow","SuccessShow","initState","email","password","err","success","Login","history","user","setUser","hide","setHide","dispatch","auth","state","handleChangeInput","e","target","name","value","handleSubmit","preventDefault","post","res","push","data","localStorage","setItem","accessToken","replace","response","msg"],"mappings":"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","sourcesContent":["import { Link, useHistory } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport React, { useState } from \"react\";\r\nimport { dispatchLogin } from \"../../redux/actions/authAction\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { ErrShow, SuccessShow } from \"../notification/Notification\";\r\n\r\nconst initState = {\r\n  email: \"\",\r\n  password: \"\",\r\n  err: \"\",\r\n  success: \"\",\r\n};\r\n\r\nconst Login = () => {\r\n  const history = useHistory();\r\n  const [user, setUser] = useState(initState);\r\n  const [hide, setHide] = useState(true);\r\n  const dispatch = useDispatch();\r\n  const auth = useSelector((state) => state.auth);\r\n\r\n  const { email, password, err, success } = user;\r\n\r\n  const handleChangeInput = (e) => {\r\n    const { name, value } = e.target;\r\n\r\n    setUser({ ...user, [name]: value, err: \"\", success: \"\" });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const res = await axios.post(\"/user/login\", { email, password });\r\n      setUser({ ...user, err: \"\", success: \"Đăng nhập thành công!\" });\r\n      auth.user.push(res.data);\r\n      localStorage.setItem(\"account\", res.data.accessToken);\r\n      dispatch(dispatchLogin());\r\n      history.replace(\"/\");\r\n    } catch (err) {\r\n      err.response.data.msg &&\r\n        setUser({ ...user, err: err.response.data.msg, success: \"\" });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <section>\r\n      <div className=\"form\">\r\n        <div className=\"box-form\">\r\n          <h1>Login</h1>\r\n          {err && ErrShow(err)}\r\n          {success && SuccessShow(success)}\r\n          <form onSubmit={handleSubmit}>\r\n            <label htmlFor=\"email\">Email</label>\r\n            <input\r\n              id=\"email\"\r\n              name=\"email\"\r\n              value={email}\r\n              onChange={handleChangeInput}\r\n              placeholder=\"Nhập email...\"\r\n              type=\"email\"\r\n            />\r\n            <label htmlFor=\"password\">Password</label>\r\n            <input\r\n              id=\"password\"\r\n              name=\"password\"\r\n              value={password}\r\n              onChange={handleChangeInput}\r\n              placeholder=\"Nhập password...\"\r\n              type={hide ? \"password\" : \"text\"}\r\n            />\r\n            <p>\r\n              Hide password\r\n              <input type=\"checkbox\" onClick={() => setHide(!hide)} />\r\n            </p>\r\n\r\n            <button type=\"submit\">Đăng nhập</button>\r\n          </form>\r\n          <p>\r\n            Create new user!\r\n            <Link to=\"/user/register\">Register!</Link>\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}